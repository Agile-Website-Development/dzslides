<!DOCTYPE html>
<meta charset="utf8">
<title>master</title>

<script>
    var view, notes, count, idxp;
    window.onload = function() {
        view = document.getElementById("view").contentWindow;
        idxp = document.getElementById("idx");
        notes = document.getElementById("notes");

        view.postMessage("register", document.location);
    }

    window.addEventListener("message", function(e) {
        if (e.source === view) {
            var args = JSON.parse(e.data);
            if (args.method === "newslide") {
                var slide = view.document.querySelector("section:nth-of-type("+ args.idx +")");
                var details =slide.querySelector("details");
                if (details) {
                    notes.innerHTML = details.innerHTML;
                } else {
                    notes.innerHTML = "";
                }
                idxp.innerHTML = args.idx + "/" + count;
            }
            if (args.method === "registered") {
                count = args.count;
            }
        }
    }, false);

    function back() { view.postMessage("back", document.location); }
    function forward() { view.postMessage("forward", document.location); }
</script>

<style>
    #view {
        pointer-events: none;
        width: 800px;
        height: 600px;
        border: none;
        box-shadow: 0 0 15px black;
        margin: 20px;
        display: inline-block;
        vertical-align: top;
    }
    #notes {
        display: inline-block;
        vertical-align: top;
        margin-left: 25px;
        font-size: 2em;
    }
</style>

<iframe id="view" src="slides.html"></iframe>
<section id="notes">My notes.</section>
<p id="idx">...</p>

<div id="controls">
    <button onclick="back()">back</button>
    <button onclick="forward()">forward</button>
</div>

